grant PP_SELECT to PP23;

select  MAX_BYTES/1024/1024 KIOSZTOTT_MB, BYTES/1024/1024 FOGLALT_MB, TABLESPACE_NAME  from user_ts_quotas;--200 MB-ból csak 9,3125 MB foglalt

create table PP23.A_SEMA_VALTOZOK as select * from PP22.A_SEMA_VALTOZOK;
grant select on PP23.A_SEMA_VALTOZOK to PP_SELECT;
select * from PP23.A_SEMA_VALTOZOK;--238


create table PP23.PP23_2023M1101_V00 as select * from PP22.PP22_2022M1101_V00;
grant select on PP23.PP23_2023M1101_V00 to PP_SELECT;
grant insert, delete on PP23.PP23_2023M1101_V00 to PP_UPDATE;
--truncate table PP23.PP23_2023M1101_V00;

create table PP23.PP23_2023M1102_V00 as select * from PP22.PP22_2022M1102_V00;
grant select on PP23.PP23_2023M1102_V00 to PP_SELECT;
grant insert, delete on PP23.PP23_2023M1102_V00 to PP_UPDATE;
--truncate table PP23.PP23_2023M1102_V00;

create table PP23.PP23_2023M1103_V00 as select * from PP22.PP22_2022M1103_V00;
grant select on PP23.PP23_2023M1103_V00 to PP_SELECT;
grant insert, delete on PP23.PP23_2023M1103_V00 to PP_UPDATE;
--truncate table PP23.PP23_2023M1103_V00;

create table PP23.TEMP_PSZAFUPDATE as select * from PP22.TEMP_PSZAFUPDATE;
grant select on PP23.TEMP_PSZAFUPDATE to PP_SELECT;
grant insert, delete on PP23.TEMP_PSZAFUPDATE to PP_UPDATE;
--truncate table PP23.TEMP_PSZAFUPDATE;

create table PP23.CODES_LIST as select * from PP22.CODES_LIST;
grant select on PP23.CODES_LIST to PP_SELECT;
select * from PP23.CODES_LIST;--75


select count(*) from PP23.PP23_2023M1101_V00;--37772, 36778
select * from PP23.PP23_2023M1101_V00 order by M003, SOR_KOD;--37772 - 994 Eximbank = 36778
select sum(ERTEK) from PP23.PP23_2023M1101_V00;--586.070.751.720
select * from PP23.PP23_2023M1101_V00 where M003 = '10949638';--994 sor törölve lesz
delete from PP23.PP23_2023M1101_V00 where M003 = '10949638';
commit;

select count(*) from PP23.PP23_2023M1102_V00;--3976
select * from PP23.PP23_2023M1102_V00 order by M003, SOR_KOD;--3976
select sum(ERTEK) from PP23.PP23_2023M1102_V00;--230.913.312.869
select * from PP23.PP23_2023M1102_V00 where M003 = '10949638';--0

select count(*) from PP23.PP23_2023M1103_V00;--2698, 2627
select * from PP23.PP23_2023M1103_V00 order by M003, SOR_KOD;--2698 - 71 Eximnak = 2627
select sum(ERTEK) from PP23.PP23_2023M1103_V00;--72.754.829.271
select * from PP23.PP23_2023M1103_V00 where M003 = '10949638';--71 sor törölve lesz
delete from PP23.PP23_2023M1103_V00 where M003 = '10949638';
commit;


select count(*) from PP23.TEMP_PSZAFUPDATE;--1.494.769, 1.494.321
select * from PP23.TEMP_PSZAFUPDATE order by M003, SOR_KOD, OSZLOP_KOD;--1.494.769 - 448 Eximbank = 1.494.321
--select * from PP23.TEMP_PSZAFUPDATE where SOR_KOD like '7C%' order by M003, SOR_KOD, OSZLOP_KOD;
select * from PP23.TEMP_PSZAFUPDATE where M003 = '10949638';--448 sor törölve lesz
delete from PP23.TEMP_PSZAFUPDATE where M003 = '10949638';
commit;


create table PP23.PP23_A_FORRASKAT_HIT as select * from PP22.PP22_A_FORRASKAT_HIT;
grant select on PP23.PP23_A_FORRASKAT_HIT to PP_SELECT;
select * from PP23.PP23_A_FORRASKAT_HIT;--1065

create table PP23.ATKOD as select * from PP22.ATKOD;
grant select on PP23.ATKOD to PP_SELECT;
select * from PP23.ATKOD order by KOD_ID;--1444

--2 új rekord beszúrása az új 2023. adatévi ATKOD táblába:
/*
select distinct KOD_ID from PP23.ATKOD order by to_number(KOD_ID) desc;--KOD_ID érték melyik legyen = legnagyobb + 1
--oszlopkód lehet 1-es, mert az UPDATE_EVES_TABLES eljárás nem veszi figyelembe az utolsó attribútummal egyetemben

insert into PP23.ATKOD(PSZAF_KOD, LEIRAS, HIC_KOD, OSZLOP_KOD, KOD_ID) values('42YE35', 'Tárgyidõszakban az eredményben elszámolt pótadó', 'PBC158', '2', '154');
insert into PP23.ATKOD(PSZAF_KOD, LEIRAS, HIC_KOD, OSZLOP_KOD, KOD_ID) values('42YE36', 'Tárgyidõszakban az adóhatóság részére megfizetett pótadó', 'PBC159', '2', '154');
commit;

select * from PP23.ATKOD where PSZAF_KOD like '42YE35' or PSZAF_KOD like '42YE36';

SELECT owner, table_name, column_name, comments FROM ALL_COL_COMMENTS where owner like 'PP23' and column_name like 'PBC%' order by table_name, column_name;
--PP23.PP23_W_BIZT_T táblában találhatóak PBC kezdetû mutatók

desc PP23.PP23_W_BIZT_T;

alter table PP23.PP23_W_BIZT_T add PBC158 NUMBER(15);
alter table PP23.PP23_W_BIZT_T add PBC159 NUMBER(15);

select * from PP23.CODES_LIST where type = 'bizt' and SOR_KOD like '42YE%';
*/

select * from PP23.CODES_LIST where type = 'bizt' and SOR_KOD like '42YE%';

create table PP23.PP23_W_PENZT_MNYP_T as select * from PP22.PP22_W_PENZT_MNYP_T;
--truncate table PP23.PP23_W_PENZT_MNYP_T;
grant select on PP23.PP23_W_PENZT_MNYP_T to PP_SELECT;


create table PP23.PP23_W_PENZT_EGESZ_T as select * from PP22.PP22_W_PENZT_EGESZ_T;
--truncate table PP23.PP23_W_PENZT_EGESZ_T;
grant select on PP23.PP23_W_PENZT_EGESZ_T to PP_SELECT;

create table PP23.PP23_W_PENZT_FOGL_T as select * from PP22.PP22_W_PENZT_FOGL_T;
--truncate table PP23.PP23_W_PENZT_FOGL_T;
grant select on PP23.PP23_W_PENZT_FOGL_T to PP_SELECT;

create table PP23.PP23_W_PENZT_ONK_T as select * from PP22.PP22_W_PENZT_ONK_T;
--truncate table PP23.PP23_W_PENZT_ONK_T;
grant select on PP23.PP23_W_PENZT_ONK_T to PP_SELECT;

create table PP23.PP23_W_PENZ_VALL_T as select * from PP22.PP22_W_PENZ_VALL_T;
--truncate table PP23.PP23_W_PENZ_VALL_T;
grant select on PP23.PP23_W_PENZ_VALL_T to PP_SELECT;

create table PP23.PP23_W_BIZT_T as select * from PP22.PP22_W_BIZT_T;
--truncate table PP23.PP23_W_BIZT_T;
grant select on PP23.PP23_W_BIZT_T to PP_SELECT;

create table PP23.PP23_W_BIZT_41A_T as select * from PP22.PP22_W_BIZT_41A_T;
--truncate table PP23.PP23_W_BIZT_41A_T;
grant select on PP23.PP23_W_BIZT_41A_T to PP_SELECT;

create table PP23.PP23_W_BEF_ALAP_T as select * from PP22.PP22_W_BEF_ALAP_T;
--truncate table PP23.PP23_W_BEF_ALAP_T;
grant select on PP23.PP23_W_BEF_ALAP_T to PP_SELECT;

create table PP23.TEMP_SORKOD as select * from PP22.TEMP_SORKOD;
--truncate table PP23.TEMP_SORKOD;
grant select on PP23.TEMP_SORKOD to PP_SELECT;

create table PP23.PP23_W_HIT_T as select * from PP22.PP22_W_HIT_T;
--truncate table PP23.PP23_W_HIT_T;
grant select on PP23.PP23_W_HIT_T to PP_SELECT;

create table PP23.PP23_W_PENZ_VALL_IFRS as select * from PP22.PP22_W_PENZ_VALL_IFRS;
--truncate table PP23.PP23_W_PENZ_VALL_IFRS;
grant select on PP23.PP23_W_PENZ_VALL_IFRS to PP_SELECT;


select * from PP23.PP23_W_HIT_T order by M003;--37
select * from PP23.PP23_W_PENZT_MNYP_T order by M003;--4
select * from PP23.PP23_W_PENZT_EGESZ_T order by M003;--15
select * from PP23.PP23_W_PENZT_FOGL_T order by M003;--1
select * from PP23.PP23_W_PENZT_ONK_T order by M003;--26
select * from PP23.PP23_W_PENZ_VALL_T order by M003;--224
select * from PP23.PP23_W_BIZT_T order by M003;--23
select * from PP23.PP23_W_BIZT_41A_T order by M003;--19
select * from PP23.PP23_W_BEF_ALAP_T order by M003;--44
select * from PP23.PP23_W_PENZ_VALL_IFRS order by M003;--11


create table PP23.A_M003_LIST as select * from PP22.A_M003_LIST;
grant select on PP23.A_M003_LIST to PP_SELECT;
select * from PP23.A_M003_LIST;


select * from PP23.TEMP_SORKOD;--üresnek kell lennie

--MNB_MNYP adatok
select sor_kod from PP23.CODES_LIST where type = 'mnyp';
truncate table PP23.TEMP_SORKOD;

set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''mnyp''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

for i in v_sorkod.first..v_sorkod.last loop

    EXECUTE IMMEDIATE'
    insert into PP23.TEMP_SORKOD(M003)
    select distinct PSZAF.M003 
    from PP23.TEMP_PSZAFUPDATE PSZAF
    where PSZAF.sor_kod like '''|| v_sorkod(i) ||'''
    '
    ;

end loop;

end;
/

truncate table PP23.PP23_W_PENZT_MNYP_T;
insert into PP23.PP23_W_PENZT_MNYP_T(MEV, M003)
select distinct '2023', M003 
from PP23.TEMP_SORKOD;


set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

TYPE t_oszlopkod IS TABLE OF NUMBER;
v_oszlopkod t_oszlopkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''mnyp''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

sql_statement := 'select oszlop_kod from PP23.CODES_LIST where type = ''mnyp''';
dbms_output.put_line(sql_statement);
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_oszlopkod;	
for i in v_sorkod.first..v_sorkod.last loop
    UPDATE_EVES_TABLES('PP23_W_PENZT_MNYP_T', ''|| v_sorkod(i) ||'' , ''|| v_oszlopkod(i) ||''); 
    
end loop;

end;
/

select * from PP23.PP23_W_PENZT_MNYP_T;--4


--MNB_EGESZ adatok
select sor_kod from PP23.CODES_LIST where type = 'egesz';
truncate table PP23.TEMP_SORKOD;

set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''egesz''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

for i in v_sorkod.first..v_sorkod.last loop

    EXECUTE IMMEDIATE'
    insert into PP23.TEMP_SORKOD(M003)
    select distinct PSZAF.M003 
    from PP23.TEMP_PSZAFUPDATE PSZAF
    where PSZAF.sor_kod like '''|| v_sorkod(i) ||'''
    '
    ;

end loop;

end;
/

truncate table PP23.PP23_W_PENZT_EGESZ_T;
insert into PP23.PP23_W_PENZT_EGESZ_T(MEV, M003)
select distinct '2023', M003 
from PP23.TEMP_SORKOD;


set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

TYPE t_oszlopkod IS TABLE OF NUMBER;
v_oszlopkod t_oszlopkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''egesz''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

sql_statement := 'SELECT oszlop_kod from PP23.CODES_LIST where type = ''egesz'' ';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_oszlopkod;	

for i in v_sorkod.first..v_sorkod.last loop

    UPDATE_EVES_TABLES('PP23_W_PENZT_EGESZ_T', ''|| v_sorkod(i) ||'' , ''|| v_oszlopkod(i) ||''); 
    
end loop;

end;
/

select * from PP23.PP23_W_PENZT_EGESZ_T;--15


--MNB_FOGL adatok
select sor_kod from PP23.CODES_LIST where type = 'fogl';
truncate table PP23.TEMP_SORKOD;

set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''fogl''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

for i in v_sorkod.first..v_sorkod.last loop

    EXECUTE IMMEDIATE'
    insert into PP23.TEMP_SORKOD(M003)
    select distinct PSZAF.M003 
    from PP23.TEMP_PSZAFUPDATE PSZAF
    where PSZAF.sor_kod like '''|| v_sorkod(i) ||'''
    '
    ;

end loop;

end;
/

truncate table PP23.PP23_W_PENZT_FOGL_T;
insert into PP23.PP23_W_PENZT_FOGL_T(MEV, M003)
select distinct '2023', M003 
from PP23.TEMP_SORKOD;


set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

TYPE t_oszlopkod IS TABLE OF NUMBER;
v_oszlopkod t_oszlopkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''fogl''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

sql_statement := 'SELECT oszlop_kod from PP23.CODES_LIST where type = ''fogl'' ';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_oszlopkod;	

for i in v_sorkod.first..v_sorkod.last loop

    UPDATE_EVES_TABLES('PP23_W_PENZT_FOGL_T', ''|| v_sorkod(i) ||'' , ''|| v_oszlopkod(i) ||''); 
    
end loop;

end;
/

select * from PP23.PP23_W_PENZT_FOGL_T;--1



--MNB_ONK adatok
select sor_kod from PP23.CODES_LIST where type = 'onk';
truncate table PP23.TEMP_SORKOD;

set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''onk''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

for i in v_sorkod.first..v_sorkod.last loop

    EXECUTE IMMEDIATE'
    insert into PP23.TEMP_SORKOD(M003)
    select distinct PSZAF.M003 
    from PP23.TEMP_PSZAFUPDATE PSZAF
    where PSZAF.sor_kod like '''|| v_sorkod(i) ||'''
    '
    ;

end loop;

end;
/

truncate table PP23.PP23_W_PENZT_ONK_T;
insert into PP23.PP23_W_PENZT_ONK_T(MEV, M003)
select distinct '2023', M003 
from PP23.TEMP_SORKOD;


set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

TYPE t_oszlopkod IS TABLE OF NUMBER;
v_oszlopkod t_oszlopkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''onk''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

sql_statement := 'SELECT oszlop_kod from PP23.CODES_LIST where type = ''onk'' ';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_oszlopkod;	

for i in v_sorkod.first..v_sorkod.last loop

    UPDATE_EVES_TABLES('PP23_W_PENZT_ONK_T', ''|| v_sorkod(i) ||'' , ''|| v_oszlopkod(i) ||''); 
    
end loop;

end;
/

select * from PP23.PP23_W_PENZT_ONK_T;--26

commit;


--MNB_PENZ adatok
select sor_kod from PP23.CODES_LIST where type = 'pvall';
truncate table PP23.TEMP_SORKOD;

set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''pvall''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

for i in v_sorkod.first..v_sorkod.last loop

    EXECUTE IMMEDIATE'
    insert into PP23.TEMP_SORKOD(M003)
    select distinct PSZAF.M003 
    from PP23.TEMP_PSZAFUPDATE PSZAF
    where PSZAF.sor_kod like '''|| v_sorkod(i) ||'''
    '
    ;

end loop;

end;
/

truncate table PP23.PP23_W_PENZ_VALL_T;
insert into PP23.PP23_W_PENZ_VALL_T(MEV, M003)
select distinct '2023', M003 
from PP23.TEMP_SORKOD;


set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

TYPE t_oszlopkod IS TABLE OF NUMBER;
v_oszlopkod t_oszlopkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''pvall''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

sql_statement := 'SELECT oszlop_kod from PP23.CODES_LIST where type = ''pvall'' ';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_oszlopkod;	

for i in v_sorkod.first..v_sorkod.last loop

    UPDATE_EVES_TABLES('PP23_W_PENZ_VALL_T', ''|| v_sorkod(i) ||'' , ''|| v_oszlopkod(i) ||''); 
    
end loop;

end;
/

select * from PP23.PP23_W_PENZ_VALL_T;--224 + 11 IFRS = 235

/*INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '10782028', '6719187', '2967504', '0', '74681', '251015', '0', '572764', '365745', '207019', '53248');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '11879978', '8717255', '5871861', '0', '293590', '105131', '0', '2195036', '510866', '1684170', '0');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '12257591', '2394863', '1026082', '0', '0', '15608', '0', '1450552', '597251', '853301', '77788');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '12238972', '29280549', '20728092', '0', '1891742', '1022565', '0', '7257448', '4058878', '3198570', '277760');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '12935181', '22131634', '7350505', '5222626', '5445795', '4775780', '0', '9444929', '4337342', '5107587', '688256');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '25978221', '1259579', '817623', '0', '896309', '73795', '0', '377912', '228643', '149269', '33691');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '12391763', '8101316,33', '3649371,04', '39035,15', '153713,25', '402031,46', '-6238,95', '16045523,9', '3255688,5', '12789835,4', '586163,86');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '13491196', '5350625', '3666171', '0', '38733', '38122', '0', '638987', '400653', '238334', '36495');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '10920394', '13328908', '12425394', '506821', '211583', '8480', '0', '2136421', '1035775', '1100646', '71508');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '24928395', '127135', '0', '0', '63', '581', '0', '53044', '29484', '23560', '0');
INSERT INTO PP23.PP23_W_PENZ_VALL_IFRS(MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032) VALUES('2023', '12158980', '7706774', '6942274', '0', '39219', '145683', '0', '1886266', '985394', '900872', '235449');
commit;*/

/*insert into PP23.PP23_W_PENZ_VALL_T(MEV, M003, PVC001, PVC002, PVC016, PVC007, PVC008, PVC009, PVC029, PVC030, PVC031, PVC032) select MEV, M003, PVF001, PVF002, PVF016, PVF007, PVF008, PVF009, PVF029, PVF030, PVF031, PVF032 from PP23.PP23_W_PENZ_VALL_IFRS;
commit;*/


--MNB_BIZT adatok
select distinct sor_kod from PP23.CODES_LIST where type = 'bizt';
truncate table PP23.TEMP_SORKOD;

set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''bizt''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

for i in v_sorkod.first..v_sorkod.last loop

    EXECUTE IMMEDIATE'
    insert into PP23.TEMP_SORKOD(M003)
    select distinct PSZAF.M003 
    from PP23.TEMP_PSZAFUPDATE PSZAF
    where PSZAF.sor_kod like '''|| v_sorkod(i) ||'''
    '
    ;

end loop;

end;
/

truncate table PP23.PP23_W_BIZT_T;
insert into PP23.PP23_W_BIZT_T(MEV, M003)
select distinct '2023', M003 
from PP23.TEMP_SORKOD;


set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

TYPE t_oszlopkod IS TABLE OF NUMBER;
v_oszlopkod t_oszlopkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''bizt''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

sql_statement := 'SELECT oszlop_kod from PP23.CODES_LIST where type = ''bizt'' ';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_oszlopkod;	

for i in v_sorkod.first..v_sorkod.last loop

    UPDATE_EVES_TABLES('PP23_W_BIZT_T', ''|| v_sorkod(i) ||'' , ''|| v_oszlopkod(i) ||''); 
    
end loop;

end;
/


select * from PP23.PP23_W_BIZT_T;--23



select * from PP23.PP23_W_BIZT_T where M003 in ('10207349', '10308024', '10337587', '10389395', '10456017', '10491984', '10765920', '10828704');
update PP23.PP23_W_BIZT_T set kompozit = 'K', int_egy = 'I' 
where M003 in ('10207349', '10308024', '10337587', '10389395', '10456017', '10491984', '10765920', '10828704');

select * from PP23.PP23_W_BIZT_T where M003 in ('10949621',  '12185960', '12761018', '12774395', '12833632', '14011838', '14489765', '14440306') order by M003;
update PP23.PP23_W_BIZT_T set kompozit = 'NE', int_egy = 'I' 
where M003 in ('10949621', '12185960', '12761018', '12774395', '12833632', '14011838', '14489765', '14440306');
--'10949621',  '14440306' nincsenek, ut¡bbi mßr van

select * from PP23.PP23_W_BIZT_T where M003 in ('10492033', '11367109', '12774412', '12833625', '14153730') order by M003;--'12582161',
update PP23.PP23_W_BIZT_T set kompozit = 'E', int_egy = 'I' where M003 in ('10492033', '11367109', '12774412', '12833625', '14153730');--'12582161', '14153730'
--hißnyoznak: '12582161', '14153730', ut¡bbi mßr van

select * from PP23.PP23_W_BIZT_T where M003 in ('18083017', '18088122', '18300941', '18373916', '18378234', '18425501', '18426997', '18485110', '18830228', '18857522', '18981719', '19670656') order by M003;
update PP23.PP23_W_BIZT_T set kompozit = 'NE', int_egy = 'E' 
where M003 in ('18083017', '18088122', '18300941', '18373916', '18378234', '18425501', '18426997', '18485110', '18830228', '18857522', '18981719', '19670656');

commit;


--2 Pannónia és 1 Gránti biztosító pótlása
select * from PP23.PP23_W_BIZT_T where M003 in ('14440306', '14153730', '14489765') order by M003;--0, majd 3
/*insert into PP23.PP23_W_BIZT_T(MEV, M003) values('2023', '14440306');
insert into PP23.PP23_W_BIZT_T(MEV, M003) values('2023', '14153730');
insert into PP23.PP23_W_BIZT_T(MEV, M003) values('2023', '14489765');
commit;*/

/*UPDATE PP23.PP23_W_BIZT_T SET PBC001 = 3133195 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBC002 = 5868800 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBC003 = 2735605 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBC101 = 4024544 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBC017 = 4024544 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM820 = 157241 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM001 = 6592475 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM002 = 1090000 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM012 = 9105236 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM013 = -3618049 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM850 = 15288 WHERE M003 = '14440306';

UPDATE PP23.PP23_W_BIZT_T SET PXC001 = 3323975 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PXC002 = 4006174 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PXC003 = 682199 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PXC101 = 2180956 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PXC017 = 2180956 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM819 = 4763115 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM820 = 181273 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM001 = 22514581 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM002 = 3116133 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM012 = 4019111 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM013 = 16366363 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM850 = -955030 WHERE M003 = '14153730';

UPDATE PP23.PP23_W_BIZT_T SET PBC001 = 28695324 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBC002 = 30485195 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBC003 = 1789871 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBC101 = 19621800 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBC017 = 19621800 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM820 = 1082110 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM001 = 39233917 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM002 = 1180043 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM012 = 1493609 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM013 = 35959513 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM850 = 600752 WHERE M003 = '14489765';

commit;*/

--MEHIB pótlása
select * from PP23.PP23_W_BIZT_T where M003 = '10949621' order by M003;--0, majd 1

/*insert into PP23.PP23_W_BIZT_T(MEV, M003) values('2023', '10949621');

UPDATE PP23.PP23_W_BIZT_T SET PBC001 = 6007456 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC002 = 5600932 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC003 = 6191285 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC004 = 1546165 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC005 = -7330926 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC014 = 901 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC016 = 149990 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC125 = 149990 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC101 = 97804 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC017 = 97804 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC019 = 66305 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC020 = -14119 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC104 = -69313 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC144 = -69313 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC145 = -11400 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC051 = 2662880 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC052 = 720732 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC054 = 1912554 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC055 = 29902 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC063 = 1211741 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC065 = 1914625 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC070 = 3609543 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC121 = 271175 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC122 = 18298 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC124 = 1265891 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC066 = 2903097 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC067 = 8646447 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC087 = -1232196 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC094 = -1232196 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC095 = 405769 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBC096 = -1637965 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM002 = 647952 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM803 = 37654950 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM806 = 37654950 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM814 = 94681 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM815 = 37560269 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM820 = 2657410 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM035 = 1831488 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM821 = 1831488 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM825 = 825922 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM826 = 667756 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM827 = 50960 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM828 = 616796 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM048 = 3420331 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM831 = 2075178 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBAOM833 = 1345153 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM001 = 7025421 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM002 = 4250000 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM013 = 4413386 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM015 = -1637965 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM807 = 35111366 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM808 = 34871108 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM809 = 41854691 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM810 = -6983583 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM854 = 240258 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM893 = 240258 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM894 = 240258 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM878 = 822193 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM862 = 822193 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM020 = 1349560 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM846 = 32251 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM847 = 1317309 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM035 = 739859 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM875 = 421323 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_T SET PBBOM876 = 318536 WHERE M003 = '10949621';
commit;*/



--MNB_BIZT_41A adatok
select sor_kod from PP23.CODES_LIST where type = 'bizt41a';
truncate table PP23.TEMP_SORKOD;

set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''bizt41a''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

for i in v_sorkod.first..v_sorkod.last loop

    EXECUTE IMMEDIATE'
    insert into PP23.TEMP_SORKOD(M003)
    select distinct PSZAF.M003 
    from PP23.TEMP_PSZAFUPDATE PSZAF
    where PSZAF.sor_kod like '''|| v_sorkod(i) ||'''
    '
    ;

end loop;

end;
/

truncate table PP23.PP23_W_BIZT_41A_T;
insert into PP23.PP23_W_BIZT_41A_T(MEV, M003)
select distinct '2023', M003 
from PP23.TEMP_SORKOD;


set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

TYPE t_oszlopkod IS TABLE OF NUMBER;
v_oszlopkod t_oszlopkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''bizt41a''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

sql_statement := 'SELECT oszlop_kod from PP23.CODES_LIST where type = ''bizt41a'' ';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_oszlopkod;	

for i in v_sorkod.first..v_sorkod.last loop

    UPDATE_EVES_TABLES('PP23_W_BIZT_41A_T', ''|| v_sorkod(i) ||'' , ''|| v_oszlopkod(i) ||''); 
    
end loop;

end;
/

select * from PP23.PP23_W_BIZT_41A_T;--19

--2 Pannónia és 1 Gránit biztosító pótlása
select * from PP23.PP23_W_BIZT_41A_T where M003 in ('14440306', '14153730', '14489765') order by M003;--0, majd 3
/*insert into PP23.PP23_W_BIZT_41A_T(MEV, M003) values('2023', '14440306');
insert into PP23.PP23_W_BIZT_41A_T(MEV, M003) values('2023', '14153730');
insert into PP23.PP23_W_BIZT_41A_T(MEV, M003) values('2023', '14489765');
commit;*/

--Volt pár nem létezõ attribútum, de nem gond:
/*UPDATE PP23.PP23_W_BIZT_41A_T SET PBC001 = 3133195 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC002 = 5868800 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC003 = 2735605 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC101 = 4024544 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC017 = 4024544 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM820 = 157241 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM001 = 6592475 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM002 = 1090000 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM012 = 9105236 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM013 = -3618049 WHERE M003 = '14440306';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM850 = 15288 WHERE M003 = '14440306';

UPDATE PP23.PP23_W_BIZT_41A_T SET PXC001 = 3323975 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PXC002 = 4006174 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PXC003 = 682199 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PXC101 = 2180956 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PXC017 = 2180956 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM819 = 4763115 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM820 = 181273 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM001 = 22514581 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM002 = 3116133 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM012 = 4019111 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM013 = 16366363 WHERE M003 = '14153730';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM850 = -955030 WHERE M003 = '14153730';

UPDATE PP23.PP23_W_BIZT_41A_T SET PBC001 = 28695324 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC002 = 30485195 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC003 = 1789871 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC101 = 19621800 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC017 = 19621800 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM820 = 1082110 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM001 = 39233917 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM002 = 1180043 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM012 = 1493609 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM013 = 35959513 WHERE M003 = '14489765';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM850 = 600752 WHERE M003 = '14489765';

commit;*/


--MEHIB pótlása
select * from PP23.PP23_W_BIZT_41A_T where M003 = '10949621' order by M003;--0, majd 1

/*insert into PP23.PP23_W_BIZT_41A_T(MEV, M003) values('2023', '10949621');

UPDATE PP23.PP23_W_BIZT_41A_T SET PBC001 = 6007456 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC002 = 5600932 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC003 = 6191285 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC004 = 1546165 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC005 = -7330926 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC014 = 901 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC016 = 149990 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC125 = 149990 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC101 = 97804 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC017 = 97804 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC019 = 66305 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC020 = -14119 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC104 = -69313 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC144 = -69313 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC145 = -11400 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC051 = 2662880 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC052 = 720732 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC054 = 1912554 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC055 = 29902 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC063 = 1211741 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC065 = 1914625 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC070 = 3609543 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC121 = 271175 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC122 = 18298 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC124 = 1265891 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC066 = 2903097 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC067 = 8646447 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC087 = -1232196 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC094 = -1232196 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC095 = 405769 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBC096 = -1637965 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM002 = 647952 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM803 = 37654950 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM806 = 37654950 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM814 = 94681 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM815 = 37560269 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM820 = 2657410 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM035 = 1831488 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM821 = 1831488 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM825 = 825922 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM826 = 667756 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM827 = 50960 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM828 = 616796 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM048 = 3420331 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM831 = 2075178 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBAOM833 = 1345153 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM001 = 7025421 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM002 = 4250000 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM013 = 4413386 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM015 = -1637965 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM807 = 35111366 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM808 = 34871108 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM809 = 41854691 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM810 = -6983583 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM854 = 240258 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM893 = 240258 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM894 = 240258 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM878 = 822193 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM862 = 822193 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM020 = 1349560 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM846 = 32251 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM847 = 1317309 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM035 = 739859 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM875 = 421323 WHERE M003 = '10949621';
UPDATE PP23.PP23_W_BIZT_41A_T SET PBBOM876 = 318536 WHERE M003 = '10949621';
commit;*/



--MNB_BEF adatok
select sor_kod from PP23.CODES_LIST where type = 'befalap';
truncate table PP23.TEMP_SORKOD;

set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''befalap''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

for i in v_sorkod.first..v_sorkod.last loop

    EXECUTE IMMEDIATE'
    insert into PP23.TEMP_SORKOD(M003)
    select distinct PSZAF.M003 
    from PP23.TEMP_PSZAFUPDATE PSZAF
    where PSZAF.sor_kod like '''|| v_sorkod(i) ||'''
    '
    ;

end loop;

end;
/

truncate table PP23.PP23_W_BEF_ALAP_T;
insert into PP23.PP23_W_BEF_ALAP_T(MEV, M003)
select distinct '2023', M003 
from PP23.TEMP_SORKOD;


set serveroutput on;
declare
sql_statement VARCHAR2(1000);

TYPE t_sorkod IS TABLE OF VARCHAR2(10);
v_sorkod t_sorkod;

TYPE t_oszlopkod IS TABLE OF NUMBER;
v_oszlopkod t_oszlopkod;

begin

sql_statement := 'select sor_kod from PP23.CODES_LIST where type = ''befalap''';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_sorkod;

sql_statement := 'SELECT oszlop_kod from PP23.CODES_LIST where type = ''befalap'' ';
EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_oszlopkod;	

for i in v_sorkod.first..v_sorkod.last loop

    UPDATE_EVES_TABLES('PP23_W_BEF_ALAP_T', ''|| v_sorkod(i) ||'' , ''|| v_oszlopkod(i) ||''); 
    
end loop;

end;
/

select * from PP23.PP23_W_BEF_ALAP_T;--44


--HITELITÉZET adatok
truncate table PP23.PP23_W_HIT_T;
begin
    HITELINTEZET_BETOLT_EVES.INDIT('2023');
end;
/

select * from PP23.PP23_W_HIT_T;--37

select M003, T003, T004, T005, T006 from PP23.PP23_W_HIT_T;--4 új mutató 2022 elõzetesre